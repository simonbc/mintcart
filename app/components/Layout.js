import Head from "next/head";
import Link from "next/link";

import { useRouter } from "next/router";

import React, { useCallback, useMemo } from "react";
import { styled } from "@stitches/react";

import {
  useAddress,
  useChainId,
  useConnect,
  useDisconnect,
  useDisplayAddress,
  Web3Provider,
} from "../context/Web3Context";

import Button from "../components/ui/Button";

const DRAWER_WIDTH = 250;
const HEADER_HEIGHT = 64;
const PAGE_MARGIN = 64;

const Layout = ({ pageTitle, children }) => {
  const router = useRouter();
  const tab = useMemo(() => router.asPath.replace(/^\/#?/, ""), [router]);
  const address = useAddress();
  const displayAddress = useDisplayAddress();
  const connectWallet = useConnect();
  const disconnectWallet = useDisconnect();

  return (
    <PageContent>
      <Head>
        <title>mintcart</title>
        <meta name="description" content="Generated by create next app" />
        <link rel="icon" href="/favicon.ico" />
      </Head>

      <PageHeader>
        <PageHeaderTitle>
          <Link href="/">
            <a>mintcart</a>
          </Link>
        </PageHeaderTitle>
        <WalletContainer>
          {address ? (
            <>
              <AddressLabel>{displayAddress}</AddressLabel>

              <Button type="primary" onClick={disconnectWallet}>
                Disconnect wallet
              </Button>
            </>
          ) : (
            <Button type="primary" onClick={connectWallet}>
              Connect wallet
            </Button>
          )}
        </WalletContainer>
      </PageHeader>
      <PageMain>{children}</PageMain>
    </PageContent>
  );
};

const PageContent = styled("div", {
  color: "#111",
  backgoundColor: "#f7f7f7",
  padding: `${PAGE_MARGIN}px`,
});

const PageHeader = styled("header", {
  display: "flex",
  alignItems: "center",
  justifyContent: "space-between",
  height: HEADER_HEIGHT,
});

const PageHeaderTitle = styled("h1", {
  fontWeight: 600,
  fontFamily: "$mono",
  fontSize: "$xxl",
  lineHeight: "41.67px",
});

const PageMain = styled("main", {
  height: `calc(100vh - ${HEADER_HEIGHT + 2 * PAGE_MARGIN}px)`,
  flex: 1,
  display: "flex",
  flexDirection: "column",
  padding: `40px 0`,
});

const WalletContainer = styled("div", {
  display: "flex",
  alignItems: "center",
  justifyContent: "flex-end",
  flexGrow: 1,
});

const AddressLabel = styled("span", {
  fontFamily: "$sans",
  marginRight: "16px",
  fontWeight: 600,
});

export default Layout;
